# Battery 电性能测试

    Battery产品支持PD、QC3.0、QC2.0、SCP、PPS、FCP、AFC、SUPERVOOC等快充协议，Battery模式可给3C类数码电子产品供电，Charger模式可进行容量存储。

    使用的电芯成分为 Li-lion。

    使用哪个系列的MCU？

输入部分

输入电流

 	测试目的：Charger模式下，评测电流值是否满足各种协议下的规定电流值大小。
        
![image](https://github.com/user-attachments/assets/dfd4ef57-9e69-4543-9215-bdea6eb28e41)
![image](https://github.com/user-attachments/assets/539e408f-3519-4d99-97f5-51cd5f71de39)
![image](https://github.com/user-attachments/assets/c270150e-d8ee-457c-971a-b824baba928f)
![image](https://github.com/user-attachments/assets/5c828e79-d04c-4ecf-a0f7-fd97a08dbb21)
![image](https://github.com/user-attachments/assets/ba3eb3b1-b85a-4e83-b90d-682fefa2af78)


测试方法：多种适配器进行协议诱骗至不同档位，用直流电源替换供电，记录模拟电池上的输入电流值大小。

输入电压

 输入过压保护与恢复





测试目的：Charger模式下，评测过压保护的电压点是否满足产品规格需求。



测试方法：协议充电器诱骗后，直流电源替换，在板端测量输入电压，0.01V步进增加，直至输入保护。再减小电压，直至输出恢复正常。

  输入欠压保护





 测试目的：Charger模式下，评测欠压保护的电压点是否满足产品规格需求。



 测试方法：协议充电器诱骗后，直流电源替换，在板端测量输入电压，0.01V步进减小，直至输入保护。再增大电压，直至输出恢复正常。

输入功率分配

  - 测试目的：Charger模式下，评测

  - 测试方法：

输入短路

  - D+/D- 短路（一般只要求5V，更高会导致MCU耐压不够损坏）

    - 测试目的：Charger模式下，评测信号传输短路时对产品的影响。如快充功能失效时，再恢复时能否正常。

    - 测试方法：

      - D+对正极短路，适配器对其充电；

      - D+对负极短路，适配器对其充电；

      - D-对正极短路，适配器对其充电；

      - D-对负极短路，适配器对其充电。

  - 输入短路 

    - 测试目的：Charger模式下，评测过流保护的电流点是否满足产品规格需求。

    - 测试方法：正负极短路再插入适配器充电；插入适配器后短路正负极；测试完成后检查充放电功能。

充电截止电流

  - 测试目的：Charger模式下，评测充电截止前的充电电流值是否满足标准要求，如0.02C为截止电流，低于这个值一段时间不进行充电。

  - 测试方法：不同输入的适配器充电，监测电芯电压和充电电流，记录充电截止前的充电电流

深度放电后充电

  - 测试目的：Charger模式下，评测电芯在低电压状态下，充电电压电流是否正常。

  - 测试方法：移除电池保护板，将每节电芯以0.2C放空至2V，再充电，查看电芯电压和充电电流是否正常。

滥用

  - 测试目的：模拟用户对各输入口乱用，防呆

  - 测试方法：

输出部分

输出电压

  - 测试目的：Battery模式下，评测输出口板端电压值是否满足各协议对应的输出电压。

  - 测试方法：测试各个协议下，负载为零或者空时，记录板端的输出；测试各个协议下，负载为满载时，记录输出末端电压

  如

![image](https://github.com/user-attachments/assets/e688da5a-deab-4516-9658-9325da4c837e)


输出压降补偿

  - 测试目的：Battery模式下，评测各协议在不同档位负载下电压值下降的变化。 PS：补偿成线性关系---伏安特性曲线

  - 测试方法：Battery模式，0.1A步进上调负载值，直至满载；再0.1A步进下调至空载，观测中间是否有突变。

输出纹波电压

  - 测试目的：Battery模式下，评测AC/DC电源性能

  - 测试方法：在空载/半载/满载三个档位下，使用去掉接地的电压探头并入一个0.1uF陶瓷电容和10uF电解电容，监测输出端。

 ![image](https://github.com/user-attachments/assets/72e0e239-bb9e-4e38-ab80-7bed111b8e9c)


  PS： 负载设置为CR模式。示波器带宽设置20M，衰减多少就放大多少。纹波采样时间为每格10ms。一般输出纹波 <= 200mV

输出动态响应

  - 测试目的：Battery模式下，评测负载动态交流带载时，输出电压值是否稳定，及动态响应的时间。

  - 测试方法：负载设置动态带载，转变斜率设置为0.15A/us，动态占空比50%，动态频率设置为100Hz，动态负载量的上限，下限按照10%~90%设置。

 
![image](https://github.com/user-attachments/assets/0296cd6e-3883-4822-a6c4-9810c4ac20a1)


输出恒流

  - 测试目的：Battery模式下，评测各协议在负载CV模式下输出电流值是否稳定。

  - 测试方法：负载设置CV恒压带载模式，电压设置空载-0.1V，打开输出后0.1V步进下调。

 
![image](https://github.com/user-attachments/assets/951192a1-714c-4d7b-856c-f60a709dc898)


输出降额

  - 测试目的：Battery模式下，评测在电芯低电压时降额是否满足要求。

  - 测试方法：模拟电池替代电芯。设置电压为4.2 * 串数，CV模式带载，0.01V下调，直至输出电流出现大幅度下降，此时电流值为降功率电流

输出功率分配

  - 测试目的：Battery模式下，检测多个输出口的功率分配是否满足要求。

  - 测试方法：按照规格书定义，多口同时输出，分别检测每个输出口的功率。

- 整机转换效率

  - 测试目的：Battery模式下，评测整个PCB板对输入输出的效率转换。

  - 测试方法：

    - 充电效率

      * 诱骗后直流电源供电，负载CV模式替代电芯；

      * 设置直流电源电压5V；

       电子负载电压分别设置为3.2V,3.7V,4.1V(多串产品电压设置n,n为串数)；

      * 分别测量并记录其充电电流lin,以及充入电芯的电流lb,计算出其充电效率。

      * 充电效率计算:

$$
	 \eta(\%)= (Vb*lb)/(Vin*lin) * 100\%

    - 放电效率

      * 直流电源替代电芯，负载额定输出；

      * 直流电压分别设置为3.2V,3.7V,4.1V(多串产品电压设置n,n为串数)；

      * 给移动电源单路输出带满载,测试移电源B+/B-电压为Vb,记录直流电源电流为Ib,带载输出口正负极电压为Vout,带载输出口电流为lout;

      * 计算测量输出口放电效率:

$$ 
\eta(\%)= (Vout*lout)/(Vb*lb) * 100\% 

  - 判定输出板端效率（除开电芯保护板）>= 90%

  

边冲边放功率分配

  - 测试目的：Battery模式下，评测边输入边输出是否正常

  - 测试方法：模拟电池替代电芯，分别将电芯电压设置为3.2V,3.7V,4.1V(多串产品电压设置n,n为串数)，再用规格要求适配器充电，同时输出按要求进行负载，记录电芯输入功率和适配器输入电压电流。

  

转换效率

  - 测试目的：Battery模式下，评测放电能量比和放电时间是否满足要求。

  - 测试方法：

    - 满充电状态下，用5V输出最大额定电流负载，记录各输出口电压 Vo；

    - 放电截止后，记录各输出口放电容量Co；

    - 计算放电能量比：

$$       
放电能量比 = ( V_o1  C_o1 + V_o2  C_o2 + ... + V_on  C_on ) / 电芯标称能量  100 \% 
$$ 

    PS：负载设置为分容模式（Model：Battery）, 放电能量比 >=80%

短路保护

  - 测试目的：Battery模式下，评测输出的短路保护是否符合要求。短路电流及延时

  - 测试方法：

    - 各个输出口的所有电压档位均需要测试，且需要在诱骗前进行短路测试。 

    - 使用继电器/空气开关短路输出的正负极，测试后输出电压10S，查看输出是否处于短路后恢复又短路的状态（轻载自恢复）

    - 去掉继电器后，测量输出电压10S，查看是否自行恢复输出/按键恢复

过流保护

  - 测试目的：Battery模式下，评测输出过流保护功能是否正常。

  - 测试方法：负载CC模式满载，上调负载电流，直至输出关闭；下调至恢复输出，若不能自行恢复，则按键观察

睡眠截止电流

  - 测试目的：Battery模式下，评测输出进入休眠状态下的电流值是否符合要求

  - 测试方法：

    - 负载从空载慢慢增加电流，直至电源指示灯/屏显亮起，此时为亮灯电流；

    - 从亮灯电流降低负载电流，直至电源指示灯/屏显熄灭，此时为睡眠电流；

    - 负载设置为分容模式（Model：Battery模式），以睡眠电流值进行分容，记录关机时间。

开机和静态电流

  - 测试目的：Battery模式下，输出待机状态下的电流值是否符合要求。

  - 测试方法：

    * 整机开机电流：

      * 断开VB+/VB-，并将电流表串联进入主回路，使用适配器充电激活后断开，按键空载，记录显示的电流值。

    * 静态电流：

      * 输出关闭后，此时电流表显示值 

    * 小电流模式（打开Type-USBA 持续2小时）

      * 记录小电流模式下空载的电芯电流，万用表测量电芯电压。

    * 小电流模式空载功率：

            功率 = 电芯电压 * 电芯电流

  * PS: 自耗电电流最好测试VB+端的。两端差异较大 

自耗电 （非真自耗电）

  - 测试目的：Battery模式下，输出口保持打开状态下的自耗电。

  - 测试方法：满充电条件下且指示灯全亮情况下，所有口插入不同子母充电线，持续24h，查看电量显示情况。

边充边放特性

  - 测试目的：Battery模式下，评测边充边放功能

  - 测试方法：输入端接入适配器，输出端带额定负载；输出端带额定负载，再输入端接入适配器，检测充放电功能是否正常。

输出过压保护

  - 测试目的：Battery模式下，评测输出过压保护是否正常

  - 测试方法：

    - V+及P- 接入直流电源（PD协议加在指定电容上）；

    - 负载输出100mA，缓慢增大V+/P-的电压，直至输出关闭；

  - PS：过压保护电压及恢复，延时 

输出欠压保护

  - 测试目的：Battery模式下，评测输出欠压保护是否正常

  - 测试方法：

    - 负载CV模式带载，万用表监测输出电压

    - 0.01V为步进降低输出电压，直至输出关闭；

  - PS：欠压保护电压及恢复，延时

Battery 安规测试

噪音

  - 测试目的：各种负载下，噪声是否达到规格要求

  - 测试方法：

    - 距离分贝仪 10cm；

    - 负载由 0%~100% （50mA阶梯）监测噪声的分贝

  - PS： 无线充MPP电量0~20%时，值 <16dB。

元件温升

  - 测试目的：充放电情况下，各个主要元器件的温飘情况。

  - 测试方法：

    - 完全充满/完全放空的样品；

    - 充电：

      - 热电偶线贴至主要元器件表面处；

      - 温度稳定后，使用适配器进行充电，保存数据采集仪上的数据；

    - 放电：

      - 热电偶线贴至主要元器件表面处；

      - 温度稳定后，负载CC模式下额定满载输出，直至放空，保存数据采集仪上的数据；

外壳温升

  - 测试目的：充放电情况下，外壳的温飘情况。

  - 测试方法：

    - 完全充满/完全放空的样品；

    - 充电：

      - 热成像仪扫瞄各个面温度最高点位，热电偶线贴至对应点位；

      - 温度稳定后，使用适配器进行充电，保存数据采集仪上的数据；

    - 放电：

      - 热成像仪扫瞄各个面温度最高点位，热电偶线贴至对应点位

      - 温度稳定后，负载CC模式下额定满载输出，直至放空，保存数据采集仪上的数据；

过温保护

  - 测试目的：充放电情况时，检测温度过高时，过温保护是否符合规格。

  - 测试方法：

    - 数据采集仪监测NTC温度、输出电压、输入电流、精密电阻电压；